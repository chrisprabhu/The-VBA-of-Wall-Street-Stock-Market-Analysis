Sub TotalStockVolumePerStock()For Each ws In ActiveWorkbook.Worksheetsws.ActivateDim i As LongDim StockNumber As IntegerDim TotalStockVolume As DoubleDim LastRow As LongLastRow = ws.Cells(Rows.Count, 1).End(xlUp).RowStockNumber = 1TotalStockVolume = 0Cells(1, 9).Value = "Ticker"Cells(1, 10).Value = "Total Stock Volume"For i = 2 To LastRowTotalStockVolume = TotalStockVolume + Cells(i, 7).Value    If Cells(i, 1).Value = Cells(i + 1, 1).Value Then        ElseIf Cells(i, 1).Value <> Cells(i + 1, 1).Value Then        StockNumber = StockNumber + 1        Cells(StockNumber, 9).Value = Cells(i, 1).Value        Cells(StockNumber, 10).Value = TotalStockVolume        TotalStockVolume = 0End IfNext iNext wsEnd Sub